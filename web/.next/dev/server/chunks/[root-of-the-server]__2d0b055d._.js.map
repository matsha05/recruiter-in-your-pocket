{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/matsha05/Desktop/dev/recruiter-in-your-pocket/web/lib/env.ts"],"sourcesContent":["function missing(name: string): never {\n  throw new Error(`Missing environment variable: ${name}`);\n}\n\nexport function getSupabaseUrl(): string {\n  return process.env.NEXT_PUBLIC_SUPABASE_URL || missing(\"NEXT_PUBLIC_SUPABASE_URL\");\n}\n\nexport function getSupabaseAnonKey(): string {\n  return process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || missing(\"NEXT_PUBLIC_SUPABASE_ANON_KEY\");\n}\n\n\n\n\n"],"names":[],"mappings":";;;;;;AAAA,SAAS,QAAQ,IAAY;IAC3B,MAAM,IAAI,MAAM,CAAC,8BAA8B,EAAE,MAAM;AACzD;AAEO,SAAS;IACd,OAAO,gFAAwC,QAAQ;AACzD;AAEO,SAAS;IACd,OAAO,wPAA6C,QAAQ;AAC9D"}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///Users/matsha05/Desktop/dev/recruiter-in-your-pocket/web/lib/supabase/serverClient.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\nimport { createServerClient } from \"@supabase/ssr\";\nimport { getSupabaseAnonKey, getSupabaseUrl } from \"../env\";\n\n/**\n * Read-only Supabase client for Server Components\n * Use for auth checks, data reads; no cookie writes allowed\n * NOTE: This is now async due to Next.js 16 changes\n */\nexport async function createSupabaseServerClient() {\n  const cookieStore = await cookies();\n\n  return createServerClient(getSupabaseUrl(), getSupabaseAnonKey(), {\n    cookies: {\n      get(name: string) {\n        return cookieStore.get(name)?.value;\n      }\n      // No set/remove: read-only in Server Components\n    }\n  });\n}\n\n/**\n * Full read-write Supabase client for Server Actions and Route Handlers\n * Use when you need to mutate auth state (sign in/out, refresh)\n * NOTE: This is now async due to Next.js 16 changes\n */\nexport async function createSupabaseServerAction() {\n  const cookieStore = await cookies();\n\n  return createServerClient(getSupabaseUrl(), getSupabaseAnonKey(), {\n    cookies: {\n      get(name: string) {\n        return cookieStore.get(name)?.value;\n      },\n      set(name: string, value: string, options: any) {\n        cookieStore.set({ name, value, ...options });\n      },\n      remove(name: string, options: any) {\n        cookieStore.set({ name, value: \"\", ...options });\n      }\n    }\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;;;;AAOO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,mJAAO;IAEjC,OAAO,IAAA,wMAAkB,EAAC,IAAA,qIAAc,KAAI,IAAA,yIAAkB,KAAI;QAChE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;QAEF;IACF;AACF;AAOO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,mJAAO;IAEjC,OAAO,IAAA,wMAAkB,EAAC,IAAA,qIAAc,KAAI,IAAA,yIAAkB,KAAI;QAChE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAY;gBAC3C,YAAY,GAAG,CAAC;oBAAE;oBAAM;oBAAO,GAAG,OAAO;gBAAC;YAC5C;YACA,QAAO,IAAY,EAAE,OAAY;gBAC/B,YAAY,GAAG,CAAC;oBAAE;oBAAM,OAAO;oBAAI,GAAG,OAAO;gBAAC;YAChD;QACF;IACF;AACF"}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///Users/matsha05/Desktop/dev/recruiter-in-your-pocket/web/app/api/checkout/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport Stripe from \"stripe\";\nimport { createSupabaseServerClient } from \"@/lib/supabase/serverClient\";\n\n// Initialize Stripe\nconst stripe = process.env.STRIPE_SECRET_KEY\n    ? new Stripe(process.env.STRIPE_SECRET_KEY, { apiVersion: \"2025-11-17.clover\" })\n    : null;\n\nconst PRICE_IDS = {\n    \"24h\": process.env.STRIPE_PRICE_ID_24H || process.env.STRIPE_PRICE_ID,\n    \"30d\": process.env.STRIPE_PRICE_ID_30D\n};\n\n// Base URL for redirects\nconst getBaseUrl = () => {\n    if (process.env.NEXT_PUBLIC_APP_URL) return process.env.NEXT_PUBLIC_APP_URL;\n    if (process.env.VERCEL_URL) return `https://${process.env.VERCEL_URL}`;\n    return \"http://localhost:3001\";\n};\n\nexport async function POST(request: Request) {\n    // Guard: Stripe must be configured\n    if (!stripe) {\n        console.error(\"[checkout] STRIPE_SECRET_KEY not set\");\n        return NextResponse.json(\n            { ok: false, message: \"Payments are not configured yet.\" },\n            { status: 500 }\n        );\n    }\n\n    try {\n        const body = await request.json();\n        const { tier, email } = body;\n\n        // Email is required for checkout\n        if (!email || typeof email !== \"string\") {\n            return NextResponse.json(\n                { ok: false, message: \"Email is required.\" },\n                { status: 400 }\n            );\n        }\n\n        // Determine tier\n        const selectedTier = tier === \"30d\" ? \"30d\" : \"24h\";\n        const priceId = PRICE_IDS[selectedTier];\n\n        if (!priceId) {\n            console.error(`[checkout] No price ID for tier: ${selectedTier}`);\n            return NextResponse.json(\n                { ok: false, message: \"Invalid pass tier.\" },\n                { status: 400 }\n            );\n        }\n\n        const tierLabel = selectedTier === \"30d\" ? \"30-Day Campaign Pass\" : \"24-Hour Fix Pass\";\n        const baseUrl = getBaseUrl();\n\n        // Check if user is already logged in (optional)\n        let userId = null;\n        try {\n            const supabase = await createSupabaseServerClient();\n            const { data: { session } } = await supabase.auth.getSession();\n            if (session?.user) {\n                userId = session.user.id;\n            }\n        } catch {\n            // Ignore - user will be created in webhook\n        }\n\n        // Create Stripe checkout session\n        // Name will be collected by Stripe in the checkout form\n        const checkoutSession = await stripe.checkout.sessions.create({\n            mode: \"payment\",\n            payment_method_types: [\"card\"],\n            line_items: [\n                {\n                    price: priceId,\n                    quantity: 1\n                }\n            ],\n            customer_email: email.trim(),\n            // Collect billing name in checkout\n            billing_address_collection: \"required\",\n            success_url: `${baseUrl}/workspace?payment=success&tier=${selectedTier}`,\n            cancel_url: `${baseUrl}/workspace?payment=cancelled`,\n            metadata: {\n                email: email.trim(),\n                tier: selectedTier,\n                tier_label: tierLabel,\n                user_id: userId || \"\"\n            },\n            allow_promotion_codes: true,\n            custom_text: {\n                submit: {\n                    message: `You're getting the ${tierLabel}. Unlimited resume reviews await!`\n                }\n            }\n        });\n\n        console.log(`[checkout] Created session for ${email}, tier: ${selectedTier}`);\n\n        return NextResponse.json({\n            ok: true,\n            url: checkoutSession.url,\n            sessionId: checkoutSession.id\n        });\n\n    } catch (err: any) {\n        console.error(\"[checkout] Error:\", err?.message);\n        return NextResponse.json(\n            { ok: false, message: err?.message || \"Checkout failed\" },\n            { status: 500 }\n        );\n    }\n}\n"],"names":[],"mappings":"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"}}]
}